"use strict";$(function(t){function e(t){return new Promise(function(e,l){n.confirm({content:function(){return n.ajax({url:"/"+t.slug+"/edit",method:"post",timeout:14e3,data:{slug:t.new_slug,title:t.new_title,js_code1:t.jscode1,js_code2:t.jscode2,html_code:t.htmlcode,publish:t.publish,slugInput:t.slugInput}}).done(function(t){var n=void 0;(n=isErrorMessage(t))?l("Error: "+n):e(t)}).fail(function(t,e){l("Server Error, "+({error:"try again"}[e]||e))})},contentLoaded:function(t,e,n){i=!1,this.close()}})})}var n=t,i=!1,l="true"===$$("div[data-signedIn]").html(),o=$$("div[data-title]").html(),u=$$("div[data-slug]").html(),a=$$("div[data-published]").html(),r=$$("div[data-author]").html(),s=l?$$("div[data-user]").html():"";$$("button.edit#save_test").click(function(t){if(t.stopPropagation(),!i){i=!0;var c=entify(ace.edit("editor1").getValue()),d=entify(ace.edit("editor2").getValue()),f=entify(ace.edit("editor3").getValue());l?n.confirm({title:"Save edits",content:"\n\t\t\t\t\t<form>\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label>title</label>\n\t\t\t\t\t\t\t<input name='title' type='text' value=\""+o+'" class="title form-control" required/>\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t'+(r!==s?'<label>new slug</label>\t\t\t\t\t\t\t\t<input name="slug" type="text" value="'+u+'" class="slug form-control" required />':"")+'\n\n\t\t\t\t\t\t\t<div class="checkbox">\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t  <input class="publish" name="publish" type="checkbox" checked=\''+!!a+"'> Publish test\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t",buttons:{formSubmit:{text:"Submit",btnClass:"btn-dark",action:function(){var t=this.$content,l=r===s,o=null,a=null;l||(o=t.find("input.slug").val(),a=toSlug(o));var g=t.find("input.title").val(),m=t.find("input.publish").is(":checked");if(!l&&!a.length||!g.length)return i=!1,n.alert({title:"Error",content:"Fill in required fields",backgroundDismiss:!0,theme:"material"});e({slug:u,new_slug:a,new_title:g,jscode1:c,jscode2:d,htmlcode:f,publish:m,slugInput:o}).then(function(t){n.alert("Test edited, redirecting ..."),window.location="/"+(a?toSlug(a):u)}).catch(function(t){n.alert(t)})}},cancel:function(){i=!1}},onContentReady:function(){var t=this,e=t.$content,n=e.find("input.slug");e.find("input.title").on("keyup",function(){n.val(toSlug(this.value))}),e.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}}):n.alert({title:"Sign in",escapeKey:!1,content:"You must sign in first",buttons:{ok:function(){i=!1}}})}})});