"use strict";$(function(t){function e(e){return new Promise(function(l,o){n.confirm({content:function(){return t.ajax({url:"/"+e.slug+"/edit",method:"post",timeout:14e3,data:{slug:e.new_slug,title:e.new_title,js_code1:e.jscode1,js_code2:e.jscode2,html_code:e.htmlcode,publish:e.publish,slugInput:e.slugInput}}).done(function(t){var e=void 0;(e=isErrorMessage(t))?o("Error: "+e):l(t)}).fail(function(t,e){o("Server Error, "+({error:"try again"}[e]||e))})},contentLoaded:function(t,e,n){i=!1,this.close()}})})}var n=t,i=!1,l="true"===$$("div[data-signedIn]").html(),o=$$("div[data-title]").html(),u=$$("div[data-slug]").html(),a=$$("div[data-published]").html(),r=$$("div[data-author]").html(),s=l?$$("div[data-user]").html():"";$$("button.edit#save_test").click(function(c){if(c.stopPropagation(),!i){i=!0;var d=entify(ace.edit("editor1").getValue()),f=entify(ace.edit("editor2").getValue()),g=entify(ace.edit("editor3").getValue());l?n.confirm({title:"Save edits",content:"\n\t\t\t\t\t<form>\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label>title</label>\n\t\t\t\t\t\t\t<input name='title' type='text' value=\""+o+'" class="title form-control" required/>\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t'+(r!==s?'<label>new slug</label>\t\t\t\t\t\t\t\t<input name="slug" type="text" value="'+u+'" class="slug form-control" required />':"")+'\n\n\t\t\t\t\t\t\t<div class="checkbox">\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t  <input class="publish" name="publish" type="checkbox" checked=\''+!!a+"'> Publish test\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t",buttons:{formSubmit:{text:"Submit",btnClass:"btn-dark",action:function(){var l=this.$content,o=r===s,a=null,c=null;o||(a=l.find("input.slug").val(),c=toSlug(a));var m=l.find("input.title").val(),h=l.find("input.publish").is(":checked");if(!o&&!c.length||!m.length)return i=!1,n.alert({title:"Error",content:"Fill in required fields",backgroundDismiss:!0,theme:"material"});e({slug:u,new_slug:c,new_title:m,jscode1:d,jscode2:f,htmlcode:g,publish:h,slugInput:a}).then(function(e){t.alert("Test edited, redirecting ..."),window.location="/"+(c?toSlug(c):u)}).catch(function(e){t.alert(e)})}},cancel:function(){i=!1}},onContentReady:function(){var t=this,e=t.$content,n=e.find("input.slug");e.find("input.title").on("keyup",function(){n.val(toSlug(this.value))}),e.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}}):t.alert({title:"Sign in",escapeKey:!1,content:"You must sign in first",buttons:{ok:function(){i=!1}}})}})});